<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VS Code Task Tracker</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Task Tracker</h1>
        
        <div id="auth-section">
            <h2 id="auth-title">Login / Register</h2>
            <form id="auth-form">
                <input type="text" id="username" placeholder="Username" required>
                <input type="password" id="password" placeholder="Password" required>
                <button type="submit" id="auth-button">Log In</button>
                <button type="button" id="switch-button">Need an account? Register</button>
                <p id="auth-message"></p>
            </form>
        </div>

        <div id="app-section" class="hidden">
            <div class="header">
                <span id="welcome-message"></span>
                <button id="logout-button">Logout</button>
            </div>
            
            <div id="task-stats">
                <p>Completed: <span id="completed-count">0</span></p>
                <p>To Complete: <span id="remaining-count">0</span></p>
            </div>

            <form id="new-task-form">
                <input type="text" id="new-task-text" placeholder="Enter a new task..." required>
                <button type="submit">Add Task</button>
            </form>

            <ul id="task-list">
                </ul>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
<style>
    body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f4;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding-top: 50px;
    margin: 0;
}

.container {
    background: #fff;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    width: 100%;
    max-width: 450px;
}

h1 {
    text-align: center;
    color: #333;
}

.hidden {
    display: none !important;
}

/* --- Auth Styling --- */
#auth-form input, #auth-form button, #switch-button {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 4px;
    border: 1px solid #ddd;
    box-sizing: border-box;
}
#auth-button {
    background-color: #007acc; /* VS Code blue */
    color: white;
    border: none;
    cursor: pointer;
}
#switch-button {
    background-color: #eee;
    cursor: pointer;
}
#auth-message {
    color: red;
    text-align: center;
}

/* --- App Styling --- */
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}
#logout-button {
    background: #e74c3c;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
}
#task-stats {
    display: flex;
    justify-content: space-around;
    padding: 10px;
    background: #f9f9f9;
    border-radius: 4px;
    margin-bottom: 15px;
}
#task-stats p {
    margin: 0;
    font-weight: bold;
}

#new-task-form {
    display: flex;
    margin-bottom: 20px;
}
#new-task-text {
    flex-grow: 1;
    padding: 10px;
    border-radius: 4px 0 0 4px;
    border: 1px solid #ddd;
}
#new-task-form button {
    padding: 10px 15px;
    background-color: #2ecc71; /* Green */
    color: white;
    border: none;
    border-radius: 0 4px 4px 0;
    cursor: pointer;
}

#task-list {
    list-style: none;
    padding: 0;
}
#task-list li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    margin-bottom: 8px;
    background: #fff;
    border: 1px solid #eee;
    border-radius: 4px;
    transition: background-color 0.3s;
}
#task-list li.completed {
    background-color: #d4edda; /* Light green for completed */
    text-decoration: line-through;
    color: #6c757d;
}

.complete-button {
    background: #007acc;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
    white-space: nowrap;
}
#task-list li.completed .complete-button {
    background: #6c757d;
    cursor: default;
}
</style>
<script>
    document.addEventListener('DOMContentLoaded', () => {
    const authSection = document.getElementById('auth-section');
    const appSection = document.getElementById('app-section');
    const authForm = document.getElementById('auth-form');
    const authTitle = document.getElementById('auth-title');
    const authButton = document.getElementById('auth-button');
    const switchButton = document.getElementById('switch-button');
    const authMessage = document.getElementById('auth-message');
    const logoutButton = document.getElementById('logout-button');
    const newTaskForm = document.getElementById('new-task-form');
    const newTaskText = document.getElementById('new-task-text');
    const taskList = document.getElementById('task-list');
    const welcomeMessage = document.getElementById('welcome-message');
    const completedCount = document.getElementById('completed-count');
    const remainingCount = document.getElementById('remaining-count');

    let isRegisterMode = false;
    let currentUser = null; // Tracks the currently logged-in user

    // --- LOCAL STORAGE KEY STRUCTURE ---
    // users: { username1: { password: '...' }, username2: { ... } }
    // tasks: { username1: [{ id: 1, text: '...', completed: false }, ...], username2: [...] }

    // --- UTILITY FUNCTIONS ---

    const getStore = (key) => {
        try {
            return JSON.parse(localStorage.getItem(key)) || {};
        } catch (e) {
            console.error(`Error parsing localStorage key ${key}:`, e);
            return {};
        }
    };

    const setStore = (key, data) => {
        localStorage.setItem(key, JSON.stringify(data));
    };

    const getTasks = (username) => {
        const allTasks = getStore('tasks');
        return allTasks[username] || [];
    };

    const saveTasks = (username, tasks) => {
        const allTasks = getStore('tasks');
        allTasks[username] = tasks;
        setStore('tasks', allTasks);
    };

    // --- AUTHENTICATION LOGIC (using Local Storage) ---

    switchButton.addEventListener('click', () => {
        isRegisterMode = !isRegisterMode;
        authTitle.textContent = isRegisterMode ? 'Register Account' : 'Login';
        authButton.textContent = isRegisterMode ? 'Register' : 'Log In';
        switchButton.textContent = isRegisterMode ? 'Already have an account? Log In' : 'Need an account? Register';
        authMessage.textContent = '';
    });

    authForm.addEventListener('submit', (e) => {
        e.preventDefault();
        authMessage.textContent = '';
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value;

        if (!username || !password) {
            authMessage.style.color = 'red';
            authMessage.textContent = 'Username and password are required.';
            return;
        }

        const users = getStore('users');

        if (isRegisterMode) {
            // Register Mode
            if (users[username]) {
                authMessage.style.color = 'red';
                authMessage.textContent = 'User already exists.';
            } else {
                users[username] = { password }; // Store password (Note: Local Storage is not secure)
                setStore('users', users);
                
                authMessage.style.color = 'green';
                authMessage.textContent = 'Registration successful. Please log in.';
                switchButton.click(); // Switch to login mode
            }
        } else {
            // Login Mode
            if (users[username] && users[username].password === password) {
                currentUser = username;
                localStorage.setItem('currentUser', username); // Keep track of the session
                
                authMessage.style.color = 'green';
                authMessage.textContent = 'Login successful!';
                checkLoginStatus(); // Switch view and load tasks
            } else {
                authMessage.style.color = 'red';
                authMessage.textContent = 'Invalid username or password.';
            }
        }
    });

    logoutButton.addEventListener('click', () => {
        localStorage.removeItem('currentUser');
        currentUser = null;
        // Switch back to auth view
        authSection.classList.remove('hidden');
        appSection.classList.add('hidden');
        taskList.innerHTML = '';
        document.getElementById('username').value = '';
        document.getElementById('password').value = '';
    });
    
    // --- TASK MANAGEMENT FUNCTIONS (using Local Storage) ---

    function renderTasks(tasks) {
        taskList.innerHTML = '';
        
        let completed = 0;
        let remaining = 0;
        
        tasks.forEach(task => {
            const li = document.createElement('li');
            li.dataset.taskId = task.id;
            
            const taskTextSpan = document.createElement('span');
            taskTextSpan.textContent = task.text;
            li.appendChild(taskTextSpan);

            if (task.completed) {
                li.classList.add('completed');
                completed++;
            } else {
                remaining++;
                const completeButton = document.createElement('button');
                completeButton.textContent = 'Complete';
                completeButton.classList.add('complete-button');
                completeButton.addEventListener('click', () => completeTask(task.id));
                li.appendChild(completeButton);
            }
            
            taskList.appendChild(li);
        });

        // Update counts
        completedCount.textContent = completed;
        remainingCount.textContent = remaining;
    }

    // Load tasks from Local Storage
    function loadTasks() {
        if (!currentUser) return;
        const tasks = getTasks(currentUser);
        renderTasks(tasks);
    }

    // Handle adding a new task
    newTaskForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const text = newTaskText.value.trim();
        if (!text || !currentUser) return;

        const tasks = getTasks(currentUser);
        
        // Find the highest existing ID or start at 1
        const maxId = tasks.reduce((max, task) => (task.id > max ? task.id : max), 0);
        
        const newTask = {
            id: maxId + 1,
            text: text,
            completed: false
        };

        tasks.push(newTask);
        saveTasks(currentUser, tasks);
        
        newTaskText.value = ''; // Clear input
        loadTasks(); // Reload the list
    });

    // Handle completing a task
    function completeTask(taskId) {
        if (!currentUser) return;
        
        const tasks = getTasks(currentUser);
        const task = tasks.find(t => t.id === taskId);

        if (task) {
            task.completed = true;
            saveTasks(currentUser, tasks);
            loadTasks(); // Reload the list
        }
    }
    
    // --- INITIALIZATION ---
    
    function checkLoginStatus() {
        currentUser = localStorage.getItem('currentUser');
        
        if (currentUser) {
            welcomeMessage.textContent = `Welcome, ${currentUser}!`;
            authSection.classList.add('hidden');
            appSection.classList.remove('hidden');
            loadTasks();
        } else {
            authSection.classList.remove('hidden');
            appSection.classList.add('hidden');
        }
    }

    checkLoginStatus();
});
</script>